<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>S4 MagicMap · RABBIT</title><meta name="title" content="S4 MagicMap · RABBIT"/><meta property="og:title" content="S4 MagicMap · RABBIT"/><meta property="twitter:title" content="S4 MagicMap · RABBIT"/><meta name="description" content="Documentation for RABBIT."/><meta property="og:description" content="Documentation for RABBIT."/><meta property="twitter:description" content="Documentation for RABBIT."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RABBIT</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../run_rabbit/">Run RABBIT</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox"/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Prepare Inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../prepare_input/prepare_genofile/">Prepare genofile</a></li><li><a class="tocitem" href="../../prepare_input/prepare_pedinfo_designcode/">Prepare pedinfo: designcode</a></li><li><a class="tocitem" href="../../prepare_input/prepare_pedinfo_pedfile/">Prepare pedinfo: pedfile</a></li><li><a class="tocitem" href="../../prepare_input/prepare_phenofile/">Prepare phenofile</a></li><li><a class="tocitem" href="../../prepare_input/prepare_convert/">Prepare by converting </a></li></ul></li><li><a class="tocitem" href="../../understand_output/">Understand outputs</a></li><li><a class="tocitem" href="../../key_options/">Key options</a></li><li><a class="tocitem" href="../../statistical_framework/">Statistical framework</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Pipeline</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../s0_pipeline_overview/">Overview</a></li><li><a class="tocitem" href="../s1_magicsimulate/">S1 MagicSimulate</a></li><li><a class="tocitem" href="../s2_magicfilter/">S2 MagicFilter</a></li><li><a class="tocitem" href="../s3_magiccall/">S3 MagicCall</a></li><li class="is-active"><a class="tocitem" href>S4 MagicMap</a></li><li><a class="tocitem" href="../s5_magicimpute/">S5 MagicImpute</a></li><li><a class="tocitem" href="../s6_magicreconstruct/">S6 MagicReconstruct</a></li><li><a class="tocitem" href="../s7_magicscan/">S7 MagicScan</a></li></ul></li><li><a class="tocitem" href="../../rabbit_cli/">CLI</a></li><li><a class="tocitem" href="../../rabbit_api/">API</a></li><li><a class="tocitem" href="../../ref/">Citations</a></li></ul><div class="docs-version-selector field has-addons visible"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"><option value="#" selected="selected">v1.0.0</option></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Pipeline</a></li><li class="is-active"><a href>S4 MagicMap</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>S4 MagicMap</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="S4-MagicMap"><a class="docs-heading-anchor" href="#S4-MagicMap">S4 MagicMap</a><a id="S4-MagicMap-1"></a><a class="docs-heading-anchor-permalink" href="#S4-MagicMap" title="Permalink"></a></h1><h3 id="MagicMap"><a class="docs-heading-anchor" href="#MagicMap">MagicMap</a><a id="MagicMap-1"></a><a class="docs-heading-anchor-permalink" href="#MagicMap" title="Permalink"></a></h3><p>The <code>magicmap</code> sequentially performs the following:</p><ol><li>Binning duplicate markers. By default, <code>isbinning = true</code> only if the number of markers &gt; 10^4. <code>magicmap</code> will skip this step if the outfile outstem*&quot;_magicmap_binning.csv.gz&quot; already exists.</li><li>Pairwise linkage disequilibrium analysis. <code>magicmap</code> will skip this step if the outfile outstem*&quot;_magicmap_magicld.csv.gz&quot; already exists.</li><li>Pairwise linkage analysis. <code>magicmap</code> will skip this step if the outfile outstem*&quot;_magicmap_magiclinkage.csv.gz&quot; already exists.</li><li>Construct genetic map.</li></ol><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>It is recommended to repeat <code>magicmap</code> with different option values for map construction such as the threshold <code>minlodcluster</code> for clustering. If a repeat running has the same <code>workdir</code> and <code>outstem</code>, <code>magicmap</code> will automatically skip each of the first three steps that are time consuming by checking if the corresponding outfile exists. To avoid skipping some of the steps, manually delete the corresponding output files.</p></div></div><pre><code class="language-julia hljs"># code for Julia
using MagicMap
cd(@__DIR__)
genofile = outstem*&quot;_magiccall_geno.vcf.gz&quot;
pedfile = outstem*&quot;_magicfilter_ped.csv&quot;
magicmap(genofile,pedfile;    
    minncluster = 2, 
    maxncluster = 10,    
    outstem
)</code></pre><pre><code class="language-bash hljs"># code for Linux shell. 
# For Window CMD, replace multiline key \ by  ^, and replace comment-key # by ::
julia rabbit_magicmap.jl -g example_magiccall_geno.vcf.gz \
    -p example_magicfilter_ped.csv \
    --minncluster 2 \
    --maxncluster 10 \        
    --nworker 5 \
    -o example</code></pre><h3 id="Output-files"><a class="docs-heading-anchor" href="#Output-files">Output files</a><a id="Output-files-1"></a><a class="docs-heading-anchor-permalink" href="#Output-files" title="Permalink"></a></h3><table><tr><th style="text-align: left">outfile</th><th style="text-align: left">Description</th></tr><tr><td style="text-align: left">outstem*&quot;_magicmap.log&quot;</td><td style="text-align: left">log file</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_binning.csv.gz&quot;</td><td style="text-align: left">results of pairwise duplicating</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_magicld.log&quot;</td><td style="text-align: left">log file for pairwise LD</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_magicld.csv.gz&quot;</td><td style="text-align: left">results of pairwise LD</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_magiclinkage.log&quot;</td><td style="text-align: left">log file for pairwise linkage</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_magiclinkage.csv.gz&quot;</td><td style="text-align: left">results of pairwise linkage</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_eigen.png&quot;</td><td style="text-align: left">plot eigenvalues from spectral clustering</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_silhouette.csv&quot;</td><td style="text-align: left">silhouette for each nlcuster</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_silhouette.png&quot;</td><td style="text-align: left">plot silhouette for marker grouping</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_LD_heatmap.png&quot;</td><td style="text-align: left">heatmap for pairwise LD</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_linkage_heatmap.png&quot;</td><td style="text-align: left">heatmap for pairwise linkage</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_map.csv.gz&quot;</td><td style="text-align: left">constructed mapfile for downstream analysis</td></tr><tr><td style="text-align: left">outstem*&quot;_magicmap_construct_compare_inputmap.png&quot;</td><td style="text-align: left">compare with inputmap of genofile (if exists)</td></tr></table><h3 id="Ouput:-LD-and-linkage-heatmap"><a class="docs-heading-anchor" href="#Ouput:-LD-and-linkage-heatmap">Ouput: LD &amp; linkage heatmap</a><a id="Ouput:-LD-and-linkage-heatmap-1"></a><a class="docs-heading-anchor-permalink" href="#Ouput:-LD-and-linkage-heatmap" title="Permalink"></a></h3><p><code>outstem*&quot;_magicmap_construct_LD_heatmap.png&quot;</code> gives the heatmap for pairwise LD analyses, where LD is measured the squared allelic correlation. </p><p><img src="../example_magicmap_construct_LD_heatmap.png" alt/></p><p><code>outstem*&quot;_magicmap_construct_linkage_heatmap.png&quot;</code> gives the heatmap for pairwise linkage analyses, where the matrix element is 1 - scaled recombination fraction. </p><p><img src="../example_magicmap_construct_linkage_heatmap.png" alt/></p><h3 id="Ouput:-clustering"><a class="docs-heading-anchor" href="#Ouput:-clustering">Ouput: clustering</a><a id="Ouput:-clustering-1"></a><a class="docs-heading-anchor-permalink" href="#Ouput:-clustering" title="Permalink"></a></h3><p><code>outstem*&quot;_magicmap_construct_eigen.png&quot;</code>  plots eigenvalues resulting from spectral clustering. The number of calculated eigenvalues is <code>ncluster</code> + 1 if <code>ncluster</code> is not nothing, and <code>maxncluster</code> + 1 otherwise.  The large gap between <code>ncluster</code>-th and (<code>ncluster</code> + 1)-th eigenvalues indicates a potentially good clustering; the eigenvalues are in an increasing order. </p><p><img src="../example_magicmap_construct_eigen.png" alt/></p><p><code>outstem*&quot;_magicmap_construct_silhouette.png&quot;</code> plots <a href="https://en.wikipedia.org/wiki/Silhouette_(clustering)">silhouette scores</a>. The silhouette score measures the closeness between a marker and its linkage group. It ranges from -1 to 1, where a high value indicates that the marker is well matched to its linkage group. </p><p><img src="../example_magicmap_construct_silhouette.png" alt/></p><h3 id="Ouput:-map-comparison"><a class="docs-heading-anchor" href="#Ouput:-map-comparison">Ouput: map comparison</a><a id="Ouput:-map-comparison-1"></a><a class="docs-heading-anchor-permalink" href="#Ouput:-map-comparison" title="Permalink"></a></h3><p><code>outstem*&quot;_magicmap_construct_compare_inputmap.png&quot;</code> compares constructed genetic map with the markermap in input <code>genofile</code> if it is not missing. </p><p><img src="../example_magicmap_construct_compare_inputmap.png" alt/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../s3_magiccall/">« S3 MagicCall</a><a class="docs-footer-nextpage" href="../s5_magicimpute/">S5 MagicImpute »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 7 January 2025 16:05">Tuesday 7 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
