<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Prepare genofile · RABBIT</title><meta name="title" content="Prepare genofile · RABBIT"/><meta property="og:title" content="Prepare genofile · RABBIT"/><meta property="twitter:title" content="Prepare genofile · RABBIT"/><meta name="description" content="Documentation for RABBIT."/><meta property="og:description" content="Documentation for RABBIT."/><meta property="twitter:description" content="Documentation for RABBIT."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RABBIT</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../run_rabbit/">Run RABBIT</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Prepare Inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li class="is-active"><a class="tocitem" href>Prepare genofile</a></li><li><a class="tocitem" href="../prepare_pedinfo_designcode/">Prepare pedinfo: designcode</a></li><li><a class="tocitem" href="../prepare_pedinfo_pedfile/">Prepare pedinfo: pedfile</a></li><li><a class="tocitem" href="../prepare_phenofile/">Prepare phenofile</a></li><li><a class="tocitem" href="../prepare_convert/">Prepare by converting </a></li></ul></li><li><a class="tocitem" href="../../understand_output/">Understand outputs</a></li><li><a class="tocitem" href="../../key_options/">Key options</a></li><li><a class="tocitem" href="../../statistical_framework/">Statistical framework</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Pipeline</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pipeline/s0_pipeline_overview/">Overview</a></li><li><a class="tocitem" href="../../pipeline/s1_magicsimulate/">S1 MagicSimulate</a></li><li><a class="tocitem" href="../../pipeline/s2_magicfilter/">S2 MagicFilter</a></li><li><a class="tocitem" href="../../pipeline/s3_magiccall/">S3 MagicCall</a></li><li><a class="tocitem" href="../../pipeline/s4_magicmap/">S4 MagicMap</a></li><li><a class="tocitem" href="../../pipeline/s5_magicimpute/">S5 MagicImpute</a></li><li><a class="tocitem" href="../../pipeline/s6_magicreconstruct/">S6 MagicReconstruct</a></li><li><a class="tocitem" href="../../pipeline/s7_magicscan/">S7 MagicScan</a></li></ul></li><li><a class="tocitem" href="../../rabbit_cli/">CLI</a></li><li><a class="tocitem" href="../../rabbit_api/">API</a></li><li><a class="tocitem" href="../../ref/">Citations</a></li></ul><div class="docs-version-selector field has-addons visible"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"><option value="#" selected="selected">v1.0.0</option></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li><a class="is-disabled">Prepare Inputs</a></li><li class="is-active"><a href>Prepare genofile</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Prepare genofile</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Prepare-genofile"><a class="docs-heading-anchor" href="#Prepare-genofile">Prepare genofile</a><a id="Prepare-genofile-1"></a><a class="docs-heading-anchor-permalink" href="#Prepare-genofile" title="Permalink"></a></h1><p>The first required input for RABBIT is a genofile, which must be a vcf file with extension &quot;.vcf&quot; or &quot;.vcf.gz&quot;. The version of vcf file format must be v4.1 or above. </p><h3 id="Include-genetic-map"><a class="docs-heading-anchor" href="#Include-genetic-map">Include genetic map</a><a id="Include-genetic-map-1"></a><a class="docs-heading-anchor-permalink" href="#Include-genetic-map" title="Permalink"></a></h3><p>A vcf file contains the physical map in the first three columns: #CHROM, POS, ID. We can provide the genetic map by adding keywords <code>LINKAGEGROUP</code> and <code>POSCM</code> in the INFO column, assuming the linkage group is #CHROM.</p><pre><code class="nohighlight hljs">#fileformat=VCFv4.3
#INFO=&lt;ID=LINKAGEGROUP,Number=1,Type=String,Description=&quot;Linkage group in genetic map&quot;&gt;
#INFO=&lt;ID=POSCM,Number=1,Type=Float,Description=&quot;Genetic marker position in centiMorgan&quot;&gt;
#CHROM	POS	ID	REF	ALT	QUAL	FILTER	INFO    FORMAT	P1	P2 Offspring1
chr1	34522	snp1	N	.	.	.	LINKAGEGROUP=LG1;POSCM=0.0   GT  0/0 1/1 ./1
chr1	54347	snp2	N	.	.	.	LINKAGEGROUP=LG1;POSCM=1.3   GT  1/1 0/0 0/1
chr1	66710	snp3	N	.	.	.	LINKAGEGROUP=LG1;POSCM=1.5   GT  0/0 ./. 0/0</code></pre><p>See <a href="../../rabbit_api/#MagicMap.magicmap"><code>MagicMap.magicmap</code></a> for constructing the genetic map. See <a href="../../rabbit_api/#MagicBase.resetmap"><code>MagicBase.resetmap</code></a> for resetting the markermap for a vcf file.</p><h3 id="Inferred-error-rates"><a class="docs-heading-anchor" href="#Inferred-error-rates">Inferred error rates</a><a id="Inferred-error-rates-1"></a><a class="docs-heading-anchor-permalink" href="#Inferred-error-rates" title="Permalink"></a></h3><p>Marker specific error rates can be inferred during genotype imputation. These estimates are saved in the INFO column using additional keywords. Denote by sequence allelic balance the expected ratio of number of reads for the reference allele to the number of reads for the alternative allele. We only consider heterozygous allelic balance, which is 1/2 if there is no allelic balance bias. For example, the INFO for snp2 could be &quot;LINKAGEGROUP=LG1;POSCM=1.3;FOUNDERERROR=0.005;OFFSPRINGERROR=0.012;SEQERROR=0.0008;ALLELEBALANCEMEAN=0.48;ALLELEBALANCEDISPERSE=0.1;ALLELEDROPOUT=0.0&quot;.</p><ul><li><code>FOUNDERERROR</code>: allelic error rate in founders.</li><li><code>OFFSPRINGERROR</code>: allelic error rate in offspring. </li><li><code>SEQERROR</code>: sequence based error rate.</li><li><code>ALLELEBALANCEMEAN</code>: mean sequence allelic balance among offspring at a marker.</li><li><code>ALLELEBALANCEDISPERSE</code>: overdispersion for the distribution of sequence allelic balance among offspring.</li><li><code>ALLELEDROPOUT</code>: 0- and 1-inflation for the distribution of sequence allelic balance among offspring.</li></ul><p>These keywords are also explained in the beginning comment lines of the vcf file.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../../run_rabbit/">« Run RABBIT</a><a class="docs-footer-nextpage" href="../prepare_pedinfo_designcode/">Prepare pedinfo: designcode »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 7 January 2025 16:47">Tuesday 7 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
