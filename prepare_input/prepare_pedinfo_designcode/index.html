<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Prepare pedinfo: designcode · RABBIT</title><meta name="title" content="Prepare pedinfo: designcode · RABBIT"/><meta property="og:title" content="Prepare pedinfo: designcode · RABBIT"/><meta property="twitter:title" content="Prepare pedinfo: designcode · RABBIT"/><meta name="description" content="Documentation for RABBIT."/><meta property="og:description" content="Documentation for RABBIT."/><meta property="twitter:description" content="Documentation for RABBIT."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../../">RABBIT</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2"><span class="docs-label">Guide</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../run_rabbit/">Run RABBIT</a></li><li><input class="collapse-toggle" id="menuitem-2-2" type="checkbox" checked/><label class="tocitem" for="menuitem-2-2"><span class="docs-label">Prepare Inputs</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../prepare_genofile/">Prepare genofile</a></li><li class="is-active"><a class="tocitem" href>Prepare pedinfo: designcode</a><ul class="internal"><li><a class="tocitem" href="#commoncross"><span><code>commoncross</code></span></a></li><li><a class="tocitem" href="#breedcross"><span><code>breedcross</code></span></a></li><li><a class="tocitem" href="#juncdist"><span><code>juncdist</code></span></a></li></ul></li><li><a class="tocitem" href="../prepare_pedinfo_pedfile/">Prepare pedinfo: pedfile</a></li><li><a class="tocitem" href="../prepare_phenofile/">Prepare phenofile</a></li><li><a class="tocitem" href="../prepare_convert/">Prepare by converting </a></li></ul></li><li><a class="tocitem" href="../../understand_output/">Understand outputs</a></li><li><a class="tocitem" href="../../key_options/">Key options</a></li><li><a class="tocitem" href="../../statistical_framework/">Statistical framework</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox"/><label class="tocitem" for="menuitem-3"><span class="docs-label">Pipeline</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../pipeline/s0_pipeline_overview/">Overview</a></li><li><a class="tocitem" href="../../pipeline/s1_magicsimulate/">S1 MagicSimulate</a></li><li><a class="tocitem" href="../../pipeline/s2_magicfilter/">S2 MagicFilter</a></li><li><a class="tocitem" href="../../pipeline/s3_magiccall/">S3 MagicCall</a></li><li><a class="tocitem" href="../../pipeline/s4_magicmap/">S4 MagicMap</a></li><li><a class="tocitem" href="../../pipeline/s5_magicimpute/">S5 MagicImpute</a></li><li><a class="tocitem" href="../../pipeline/s6_magicreconstruct/">S6 MagicReconstruct</a></li><li><a class="tocitem" href="../../pipeline/s7_magicscan/">S7 MagicScan</a></li></ul></li><li><a class="tocitem" href="../../rabbit_cli/">CLI</a></li><li><a class="tocitem" href="../../rabbit_api/">API</a></li><li><a class="tocitem" href="../../ref/">Citations</a></li></ul><div class="docs-version-selector field has-addons visible"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"><option value="#" selected="selected">v1.0.0</option></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Guide</a></li><li><a class="is-disabled">Prepare Inputs</a></li><li class="is-active"><a href>Prepare pedinfo: designcode</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Prepare pedinfo: designcode</a></li></ul></nav><div class="docs-right"><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="designcode"><a class="docs-heading-anchor" href="#designcode"><code>designcode</code></a><a id="designcode-1"></a><a class="docs-heading-anchor-permalink" href="#designcode" title="Permalink"></a></h1><p>The second required input for RABBIT is <code>pedinfo</code>, providing the pedigree information of a mapping population in form of <code>pedfile</code> or <code>designcode</code>.</p><p>For a non-subdivided population, <code>pedinfo</code> can often be provided by a string <code>designcode</code>. There are three kinds of <code>designcode</code>: <code>commcross</code>, <code>breedcross</code>, and <code>juncdist</code>. If <code>pedinfo</code> is provided by a <code>designcode</code> in form of <code>commoncross</code> or <code>juncdist</code>, <strong>samples in the <code>genofile</code> must be ordered such that founders always precede offspring</strong>. All samples in <code>genofile</code> are offspring, except the founders that are implied by <code>designcode</code>.</p><p>See <a href="../../rabbit_api/#MagicBase.parsedesign"><code>MagicBase.parsedesign</code></a> for parsing <code>designcode</code> into a struct. See <a href="../../rabbit_api/#MagicBase.vcf_extract_pedfile"><code>MagicBase.vcf_extract_pedfile</code></a> for extracting pedfile from a vcf genofile and a given <code>designcode</code> of the non-subdivided population.  </p><h2 id="commoncross"><a class="docs-heading-anchor" href="#commoncross"><code>commoncross</code></a><a id="commoncross-1"></a><a class="docs-heading-anchor-permalink" href="#commoncross" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">commoncross</header><div class="admonition-body"><ul><li>&quot;nril-selfm&quot; where &quot;nril&quot; denotes n-way recombination inbred lines (RILs), and &quot;selfm&quot; denotes m generations of inbreeding by selfing, e.g. 8ril-self4. <strong>Founders are assumed to be exchangeable when parsing the designcode.</strong></li><li>&quot;nril-sibm&quot; where &quot;nril&quot; denotes n-way RIL, and &quot;sibm&quot; denotes m generations of inbreeding by sibling, e.g. 8ril-sib20. <strong>Founders are assumed to be exchangeable when parsing the designcode.</strong></li><li>&quot;bcg-selfm&quot; where &quot;bcg&quot; denotes g generations of back cross with the <strong>first</strong> parent, and &quot;selfm&quot; denotes m generations of inbreeding by selfing, e.g. bc2-self6. &quot;bcg&quot; is the same as &quot;bcg-self0&quot;, e.g. &quot;bc2&quot;.</li><li>&quot;nstar-selfm&quot; where &quot;nstar&quot; denotes star-like crosses between the <strong>first</strong> parent and each of the other parents, and &quot;selfm&quot; denotes m generations of inbreeding by selfing, e.g. 11star-self6. Note that &quot;nstar-selfm&quot; can be used in data simulation <a href="../../rabbit_api/#MagicSimulate.magicsimulate"><code>magicsimulate</code></a>, but not in data analysis such as <a href="../../rabbit_api/#MagicImpute.magicimpute"><code>magicimpute</code></a>.   </li></ul></div></div><pre><code class="language-julia hljs">using MagicBase, Pedigrees
designinfo = parsedesign(&quot;4ril-self3&quot;;popid=&quot;4RIL&quot;)
plotped(designinfo.pedigree)</code></pre><img src="36e310c8.svg" alt="Example block output"/><pre><code class="language-julia hljs">designinfo = parsedesign(&quot;bc2-self3&quot;; popid=&quot;BC&quot;)
plotped(designinfo.pedigree)</code></pre><img src="e07311e0.svg" alt="Example block output"/><pre><code class="language-julia hljs">designinfo = parsedesign(&quot;5star-self4&quot;; popid=&quot;star&quot;)
plotped(designinfo.pedigree)</code></pre><img src="7ec11cee.svg" alt="Example block output"/><h2 id="breedcross"><a class="docs-heading-anchor" href="#breedcross"><code>breedcross</code></a><a id="breedcross-1"></a><a class="docs-heading-anchor-permalink" href="#breedcross" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">breedcross</header><div class="admonition-body"><ul><li><code>designcode</code> for <code>breedcross</code> is specified in form of <code>pedcode=&gt;nself</code>, where <code>pedcode</code> specifies the multi-way cross and <code>nself</code> specifies the number of selfing generations following the multi-way cross.</li><li>Each cross is specified by &quot;mother/g/father&quot;, where <code>g</code> is the generation of the offspring that is given by 1 + maximum of their parents&#39; generations and the generation of a founder is set to 0. <code>pedcode</code> can be obtained by recursively specifying the <code>pedcode</code> of its parents. The  notation &quot;/g/&quot; can be simplified to &quot;/&quot; for <code>g</code>=1 and to &quot;//&quot; for <code>g</code>=2.</li><li><code>nself</code> must be a nonnegative integer, <code>DH</code> denoting double haploid, or <code>FIXED</code> denoting many generations of selfings. The DH is defined by internally setting nself=1 and ishomozygous = true for all offspring.</li></ul></div></div><pre><code class="language-julia hljs">designinfo = parsedesign(&quot;P1/P2=&gt;DH&quot;; popid=&quot;DH&quot;)
plotped(designinfo.pedigree)</code></pre><img src="b6e2e535.svg" alt="Example block output"/><pre><code class="language-julia hljs">designinfo = parsedesign(&quot;P1/4/P1/P2//P3/P4/3/P1/P2//P3/P4=&gt;2&quot;; popid=&quot;breedcross&quot;)
plotped(designinfo.pedigree)</code></pre><img src="e347c347.svg" alt="Example block output"/><h2 id="juncdist"><a class="docs-heading-anchor" href="#juncdist"><code>juncdist</code></a><a id="juncdist-1"></a><a class="docs-heading-anchor-permalink" href="#juncdist" title="Permalink"></a></h2><div class="admonition is-info"><header class="admonition-header">juncdist</header><div class="admonition-body"><ul><li><code>juncdist</code> can be used to specify a mapping population without a known pedigree, for example, because of random mating in intermediate generations, if the average junction density such as map expansion can be estimated analytically or by simulation for given mate schemes.</li><li><code>juncdist</code> assumes that the founders in each subpopulation are exchangeable. Internally <code>isfglexch=true</code> is set in <code>offspringinfo</code> for the offspring in the subpopulation.</li></ul></div></div><p>The following shows an example <code>designcode</code> in form of <code>juncdist</code>.</p><pre><code class="language-julia hljs">designinfo = parsedesign(&quot;nfounder=3||ibd=1.0||mapexpansion=5.0&quot;)
designinfo.juncdist</code></pre><pre class="documenter-example-output"><code class="nohighlight hljs ansi">JuncDist(3, 1.0, 5.0, nothing, nothing, nothing, nothing, nothing)</code></pre><p>See <a href="../../rabbit_api/#MagicPrior.magicorigin"><code>MagicPrior.magicorigin</code></a> for calculating junction densities from a pedigree. </p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../prepare_genofile/">« Prepare genofile</a><a class="docs-footer-nextpage" href="../prepare_pedinfo_pedfile/">Prepare pedinfo: pedfile »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Tuesday 7 January 2025 16:05">Tuesday 7 January 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
